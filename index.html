<!DOCTYPE html>

<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meine Einkaufsliste</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const ShoppingCart = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
      </svg>
    );

    const Plus = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
      </svg>
    );

    const Trash2 = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
        <line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/>
      </svg>
    );

    const Check = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    );

    const Edit2 = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
      </svg>
    );

    const X = ({ size = 24, className = "" }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    );

    const Euro = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M4 10h12"/><path d="M4 14h9"/><path d="M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12a7.9 7.9 0 0 0 7.8 8 7.7 7.7 0 0 0 5.2-2"/>
      </svg>
    );

    const Calculator = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="4" y="2" width="16" height="20" rx="2"/><line x1="8" y1="6" x2="16" y2="6"/>
      </svg>
    );

    const Share2 = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/>
        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/>
      </svg>
    );

    function ShoppingListApp() {
      const [items, setItems] = useState([]);
      const [inputValue, setInputValue] = useState('');
      const [quantityValue, setQuantityValue] = useState('1');
      const [unitPriceValue, setUnitPriceValue] = useState('');
      const [editingId, setEditingId] = useState(null);
      const [editText, setEditText] = useState('');
      const [editQuantity, setEditQuantity] = useState('');
      const [editUnitPrice, setEditUnitPrice] = useState('');
      const [showSaveMessage, setShowSaveMessage] = useState(false);
      const [showShareText, setShowShareText] = useState(false);
      const [shareTextContent, setShareTextContent] = useState('');

      useEffect(() => {
        const saved = localStorage.getItem('shoppingList');
        if (saved) {
          try {
            setItems(JSON.parse(saved));
          } catch (e) {
            console.error('Fehler beim Laden:', e);
          }
        }
      }, []);

      useEffect(() => {
        localStorage.setItem('shoppingList', JSON.stringify(items));
      }, [items]);

      const calculateTotal = (quantity, unitPrice) => {
        const qty = parseFloat(quantity) || 1;
        const price = parseFloat(unitPrice) || 0;
        return qty * price;
      };

      const addItem = () => {
        if (inputValue.trim()) {
          const qty = parseFloat(quantityValue) || 1;
          const unitPrice = parseFloat(unitPriceValue) || 0;
          const totalPrice = calculateTotal(qty, unitPrice);
          
          setItems([...items, { 
            id: Date.now(), 
            text: inputValue, 
            quantity: qty,
            unitPrice: unitPrice,
            totalPrice: totalPrice,
            completed: false 
          }]);
          setInputValue('');
          setQuantityValue('1');
          setUnitPriceValue('');
          showSaved();
        }
      };

      const toggleItem = (id) => {
        setItems(items.map(item => 
          item.id === id ? { ...item, completed: !item.completed } : item
        ));
      };

      const deleteItem = (id) => {
        setItems(items.filter(item => item.id !== id));
      };

      const startEdit = (item) => {
        setEditingId(item.id);
        setEditText(item.text);
        setEditQuantity(item.quantity || '1');
        setEditUnitPrice(item.unitPrice || '');
      };

      const saveEdit = () => {
        const qty = parseFloat(editQuantity) || 1;
        const unitPrice = parseFloat(editUnitPrice) || 0;
        const totalPrice = calculateTotal(qty, unitPrice);
        
        setItems(items.map(item =>
          item.id === editingId
            ? { ...item, text: editText, quantity: qty, unitPrice: unitPrice, totalPrice: totalPrice }
            : item
        ));
        setEditingId(null);
        showSaved();
      };

      const cancelEdit = () => {
        setEditingId(null);
      };

      const clearCompleted = () => {
        setItems(items.filter(item => !item.completed));
      };

      const showSaved = () => {
        setShowSaveMessage(true);
        setTimeout(() => setShowSaveMessage(false), 2000);
      };

      const shareList = async () => {
        const listText = items
          .filter(item => !item.completed)
          .map(item => {
            let line = `‚Ä¢ ${item.text}`;
            if (item.quantity > 1) line += ` (${item.quantity}x)`;
            if (item.totalPrice > 0) line += ` - ‚Ç¨${item.totalPrice.toFixed(2)}`;
            return line;
          })
          .join('\n');
        
        const fullText = `üõí Einkaufsliste\n\n${listText}\n\nGesamt: ‚Ç¨${totalPrice.toFixed(2)}`;

        if (navigator.share) {
          try {
            await navigator.share({
              title: 'Meine Einkaufsliste',
              text: fullText,
            });
            return;
          } catch (err) {
            if (err.name !== 'AbortError') {
              console.error('Share-Fehler:', err);
            }
          }
        }
        
        if (navigator.clipboard && navigator.clipboard.writeText) {
          try {
            await navigator.clipboard.writeText(fullText);
            alert('‚úÖ Liste in Zwischenablage kopiert!');
            return;
          } catch (err) {
            console.error('Clipboard-Fehler:', err);
          }
        }
        
        const textArea = document.createElement('textarea');
        textArea.value = fullText;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          const successful = document.execCommand('copy');
          document.body.removeChild(textArea);
          if (successful) {
            alert('‚úÖ Liste in Zwischenablage kopiert!');
            return;
          }
        } catch (err) {
          document.body.removeChild(textArea);
        }
        
        setShareTextContent(fullText);
        setShowShareText(true);
      };

      const completedCount = items.filter(item => item.completed).length;
      const totalCount = items.length;
      const totalPrice = items.reduce((sum, item) => sum + (item.totalPrice || 0), 0);
      const completedPrice = items.filter(item => item.completed).reduce((sum, item) => sum + (item.totalPrice || 0), 0);
      const remainingPrice = totalPrice - completedPrice;
      const currentTotal = calculateTotal(quantityValue, unitPriceValue);

      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
          <div className="max-w-2xl mx-auto">
            {showSaveMessage && (
              <div className="fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-6 py-3 rounded-xl shadow-lg z-50 flex items-center gap-2">
                <Check size={20} className="text-white" />
                <span className="font-semibold">Automatisch gespeichert!</span>
              </div>
            )}

            {showShareText && (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" onClick={() => setShowShareText(false)}>
                <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6" onClick={(e) => e.stopPropagation()}>
                  <div className="flex items-center justify-between mb-4">
                    <h3 className="text-xl font-bold text-gray-800 flex items-center gap-2">
                      <Share2 size={24} />
                      Liste teilen
                    </h3>
                    <button onClick={() => setShowShareText(false)} className="text-gray-400 hover:text-gray-600 p-1">
                      <X size={24} />
                    </button>
                  </div>
                  
                  <p className="text-sm text-gray-600 mb-3">
                    Halte den Text gedr√ºckt und w√§hle "Kopieren":
                  </p>
                  
                  <div className="bg-gray-50 rounded-xl p-4 mb-4 max-h-64 overflow-y-auto">
                    <pre className="whitespace-pre-wrap text-sm text-gray-800">{shareTextContent}</pre>

```
              </div>
              
              <button
                onClick={() => {
                  const textArea = document.createElement('textarea');
                  textArea.value = shareTextContent;
                  textArea.style.position = 'fixed';
                  textArea.style.left = '-999999px';
                  document.body.appendChild(textArea);
                  textArea.select();
                  try {
                    document.execCommand('copy');
                    alert('‚úÖ In Zwischenablage kopiert!');
                  } catch (err) {
                    alert('Bitte manuell kopieren');
                  }
                  document.body.removeChild(textArea);
                }}
                className="w-full bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-xl font-semibold"
              >
                Text kopieren
              </button>
            </div>
          </div>
        )}

        <div className="bg-white rounded-t-3xl shadow-lg p-6">
          <div className="flex items-center justify-between mb-4">
            <div className="flex items-center gap-3">
              <div className="bg-indigo-500 p-3 rounded-2xl">
                <ShoppingCart size={28} className="text-white" />
              </div>
              <div>
                <h1 className="text-3xl font-bold text-gray-800">Einkaufsliste</h1>
                <p className="text-gray-500 text-sm">{completedCount} von {totalCount} erledigt</p>
              </div>
            </div>
            <div className="text-right">
              <div className="flex items-center gap-1 text-2xl font-bold text-indigo-600">
                <Euro size={24} />
                <span>{totalPrice.toFixed(2)}</span>
              </div>
              {completedPrice > 0 && (
                <p className="text-sm text-gray-500">Noch: ‚Ç¨{remainingPrice.toFixed(2)}</p>
              )}
            </div>
          </div>

          <div className="flex gap-2 pt-4 border-t border-gray-200">
            <button
              onClick={shareList}
              disabled={items.length === 0}
              className="flex-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white px-4 py-2 rounded-xl flex items-center justify-center gap-2 font-medium text-sm"
            >
              <Share2 size={18} />
              <span>Liste teilen</span>
            </button>
          </div>
        </div>

        <div className="bg-white shadow-lg p-4 border-t border-gray-100">
          <div className="flex flex-col gap-3">
            <input
              type="text"
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              onKeyPress={(e) => e.key === 'Enter' && addItem()}
              placeholder="Artikel..."
              className="flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none text-lg"
            />
            
            <div className="flex gap-2 items-center">
              <div className="flex-1 flex gap-2">
                <div className="flex-1">
                  <label className="text-xs text-gray-500 mb-1 block px-1">Anzahl</label>
                  <input
                    type="number"
                    step="0.1"
                    min="0.1"
                    value={quantityValue}
                    onChange={(e) => setQuantityValue(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && addItem()}
                    className="w-full px-3 py-2 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none text-lg"
                  />
                </div>
                <div className="flex items-center justify-center pt-6">
                  <X size={20} className="text-gray-400" />
                </div>
                <div className="flex-1">
                  <label className="text-xs text-gray-500 mb-1 block px-1">St√ºckpreis ‚Ç¨</label>
                  <input
                    type="number"
                    step="0.01"
                    min="0"
                    value={unitPriceValue}
                    onChange={(e) => setUnitPriceValue(e.target.value)}
                    onKeyPress={(e) => e.key === 'Enter' && addItem()}
                    placeholder="0.00"
                    className="w-full px-3 py-2 border-2 border-gray-200 rounded-xl focus:border-indigo-500 focus:outline-none text-lg"
                  />
                </div>
              </div>
              
              {currentTotal > 0 && (
                <div className="bg-green-50 px-4 py-2 rounded-xl border-2 border-green-200">
                  <div className="text-xs text-green-600 font-medium flex items-center gap-1">
                    <Calculator size={12} />
                    Gesamt
                  </div>
                  <div className="text-lg font-bold text-green-700">‚Ç¨{currentTotal.toFixed(2)}</div>
                </div>
              )}
            </div>
            
            <button
              onClick={addItem}
              className="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-xl flex items-center justify-center gap-2 font-semibold"
            >
              <Plus size={20} />
              <span>Hinzuf√ºgen</span>
            </button>
          </div>
        </div>

        <div className="bg-white rounded-b-3xl shadow-lg p-4">
          {items.length === 0 ? (
            <div className="text-center py-12">
              <div className="bg-gray-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                <ShoppingCart size={40} className="text-gray-400" />
              </div>
              <p className="text-gray-500 text-lg">Deine Einkaufsliste ist leer</p>
              <p className="text-gray-400 text-sm mt-1">F√ºge Artikel hinzu!</p>
            </div>
          ) : (
            <>
              <div className="space-y-2 max-h-96 overflow-y-auto">
                {items.map(item => (
                  <div key={item.id} className="flex items-center gap-3 p-4 bg-gray-50 rounded-xl hover:bg-gray-100">
                    {editingId === item.id ? (
                      <>
                        <div className="flex-1 flex flex-col gap-2">
                          <input
                            type="text"
                            value={editText}
                            onChange={(e) => setEditText(e.target.value)}
                            className="px-3 py-2 border-2 border-indigo-300 rounded-lg focus:outline-none text-lg"
                          />
                          <div className="flex gap-2 items-center">
                            <input
                              type="number"
                              step="0.1"
                              value={editQuantity}
                              onChange={(e) => setEditQuantity(e.target.value)}
                              placeholder="Anzahl"
                              className="flex-1 px-3 py-2 border-2 border-indigo-300 rounded-lg focus:outline-none"
                            />
                            <X size={16} className="text-gray-400" />
                            <input
                              type="number"
                              step="0.01"
                              value={editUnitPrice}
                              onChange={(e) => setEditUnitPrice(e.target.value)}
                              placeholder="‚Ç¨"
                              className="flex-1 px-3 py-2 border-2 border-indigo-300 rounded-lg focus:outline-none"
                            />
                            <div className="text-sm font-semibold text-indigo-600">
                              = ‚Ç¨{calculateTotal(editQuantity, editUnitPrice).toFixed(2)}
                            </div>
                          </div>
                        </div>
                        <button onClick={saveEdit} className="text-green-600 hover:bg-green-50 p-2 rounded-lg">
                          <Check size={20} />
                        </button>
                        <button onClick={cancelEdit} className="text-gray-500 hover:bg-gray-200 p-2 rounded-lg">
                          <X size={20} />
                        </button>
                      </>
                    ) : (
                      <>
                        <button
                          onClick={() => toggleItem(item.id)}
                          className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center ${
                            item.completed ? 'bg-green-500 border-green-500' : 'border-gray-300'
                          }`}
                        >
                          {item.completed && <Check size={16} className="text-white" />}
                        </button>
                        <div className="flex-1">
                          <div className="flex items-baseline gap-2">
                            <span className={`text-lg font-medium ${item.completed ? 'line-through text-gray-400' : 'text-gray-700'}`}>
                              {item.text}
                            </span>
                            {item.quantity > 1 && (
                              <span className={`text-sm ${item.completed ? 'text-gray-400' : 'text-gray-500'}`}>
                                ({item.quantity}x)
                              </span>
                            )}
                          </div>
                          {item.unitPrice > 0 && (
                            <div className={`text-xs mt-1 ${item.completed ? 'text-gray-400' : 'text-gray-500'}`}>
                              {item.quantity > 1 ? `${item.quantity}x √† ‚Ç¨${item.unitPrice.toFixed(2)}` : `St√ºckpreis: ‚Ç¨${item.unitPrice.toFixed(2)}`}
                            </div>
                          )}
                          {item.totalPrice > 0 && (
                            <div className={`flex items-center gap-1 text-sm font-bold mt-1 ${item.completed ? 'text-gray-400' : 'text-indigo-600'}`}>
                              <Calculator size={14} />
                              <span>‚Ç¨{item.totalPrice.toFixed(2)}</span>
                            </div>
                          )}
                        </div>
                        <button onClick={() => startEdit(item)} className="text-blue-500 hover:bg-blue-50 p-2 rounded-lg">
                          <Edit2 size={18} />
                        </button>
                        <button onClick={() => deleteItem(item.id)} className="text-red-500 hover:bg-red-50 p-2 rounded-lg">
                          <Trash2 size={18} />
                        </button>
                      </>
                    )}
                  </div>
                ))}
              </div>

              {completedCount > 0 && (
                <div className="mt-4 pt-4 border-t border-gray-200 flex justify-between items-center">
                  <button onClick={clearCompleted} className="text-red-500 hover:text-red-600 font-medium text-sm">
                    Erledigte l√∂schen ({completedCount})
                  </button>
                  {completedPrice > 0 && (
                    <div className="text-sm text-gray-500">
                      Ausgegeben: <span className="font-semibold">‚Ç¨{completedPrice.toFixed(2)}</span>
                    </div>
                  )}
                </div>
              )}
            </>
          )}
        </div>
      </div>
    </div>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<ShoppingListApp />);
```

  </script>
</body>
</html>
